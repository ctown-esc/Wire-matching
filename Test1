<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wire Matching Puzzle</title>

<style>
/* ===============================
   BASIC PAGE STYLING
================================= */
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #f4f6f8;
    display: flex;
    flex-direction: column;
    align-items: center;
}

h1 {
    margin-top: 20px;
}

#game {
    position: relative;
    width: 90%;
    max-width: 800px;
    height: 400px;
    margin-top: 30px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

/* ===============================
   WIRE COLUMN STYLING
================================= */
.column {
    display: flex;
    flex-direction: column;
    justify-content: space-around;
    height: 100%;
}

/* Individual wire container */
.wire {
    display: flex;
    align-items: center;
    cursor: pointer;
    transition: transform 0.2s ease;
}

/* Hover effect */
.wire:hover {
    transform: scale(1.05);
}

/* Wire line */
.wire-line {
    width: 100px;
    height: 8px;
    border-radius: 4px;
}

/* Connector circle */
.connector {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    border: 3px solid #333;
    background: white;
}

/* Position connector for left and right */
.left .connector {
    margin-right: 5px;
}

.right .connector {
    margin-left: 5px;
}

/* Success animation */
.connected {
    animation: snap 0.3s ease forwards;
}

@keyframes snap {
    0% { transform: scale(1); }
    50% { transform: scale(1.15); }
    100% { transform: scale(1); }
}

/* Wrong match animation */
.wrong {
    animation: shake 0.4s ease;
}

@keyframes shake {
    0%,100% { transform: translateX(0); }
    25% { transform: translateX(-5px); }
    75% { transform: translateX(5px); }
}

/* SVG overlay for connection lines */
svg {
    position: absolute;
    width: 100%;
    height: 100%;
    pointer-events: none;
}

/* Success message */
#message {
    margin-top: 20px;
    font-size: 20px;
    font-weight: bold;
    color: green;
    display: none;
}

button {
    margin-top: 10px;
    padding: 10px 20px;
    font-size: 16px;
    cursor: pointer;
}

/* Responsive layout */
@media (max-width: 768px) {
    #game {
        height: 500px;
    }
}
</style>
</head>

<body>

<h1>Wire Matching Puzzle</h1>

<div id="game">
    <!-- SVG for drawing connection lines -->
    <svg id="connections"></svg>

    <!-- Left column (randomized order) -->
    <div class="column left" id="leftColumn"></div>

    <!-- Right column (fixed order) -->
    <div class="column right" id="rightColumn"></div>
</div>

<div id="message">All wires connected!</div>
<button id="resetBtn" style="display:none;">Play Again</button>

<script>
/* ==========================================
   GLOBAL VARIABLES
========================================== */
const colors = ["red", "blue", "green"];
let selectedLeft = null;
let connections = {};
let correctMatches = 0;

/* ==========================================
   SHUFFLE FUNCTION
   Randomizes left wire order each reset
========================================== */
function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

/* ==========================================
   INITIALIZE WIRES
   Builds left and right columns
========================================== */
function initWires() {
    const leftColumn = document.getElementById("leftColumn");
    const rightColumn = document.getElementById("rightColumn");
    const svg = document.getElementById("connections");

    leftColumn.innerHTML = "";
    rightColumn.innerHTML = "";
    svg.innerHTML = "";

    connections = {};
    correctMatches = 0;
    selectedLeft = null;

    document.getElementById("message").style.display = "none";
    document.getElementById("resetBtn").style.display = "none";

    // Randomize left side
    const shuffledColors = shuffle([...colors]);

    shuffledColors.forEach(color => {
        leftColumn.appendChild(createWire(color, "left"));
    });

    // Fixed order on right
    colors.forEach(color => {
        rightColumn.appendChild(createWire(color, "right"));
    });
}

/* ==========================================
   CREATE WIRE ELEMENT
========================================== */
function createWire(color, side) {
    const wire = document.createElement("div");
    wire.classList.add("wire");
    wire.dataset.color = color;

    const line = document.createElement("div");
    line.classList.add("wire-line");
    line.style.backgroundColor = color;

    const connector = document.createElement("div");
    connector.classList.add("connector");

    if (side === "left") {
        wire.appendChild(connector);
        wire.appendChild(line);
        wire.addEventListener("click", () => selectLeftWire(wire));
    } else {
        wire.appendChild(line);
        wire.appendChild(connector);
        wire.addEventListener("click", () => connectWire(wire));
    }

    return wire;
}

/* ==========================================
   HANDLE LEFT SELECTION
========================================== */
function selectLeftWire(wire) {
    if (connections[wire.dataset.color]) return;
    selectedLeft = wire;
}

/* ==========================================
   HANDLE CONNECTION ATTEMPT
   Validates match and draws SVG line
========================================== */
function connectWire(rightWire) {
    if (!selectedLeft) return;

    const leftColor = selectedLeft.dataset.color;
    const rightColor = rightWire.dataset.color;

    if (connections[leftColor]) return;

    const svg = document.getElementById("connections");

    const leftRect = selectedLeft.querySelector(".connector").getBoundingClientRect();
    const rightRect = rightWire.querySelector(".connector").getBoundingClientRect();
    const gameRect = document.getElementById("game").getBoundingClientRect();

    const line = document.createElementNS("http://www.w3.org/2000/svg", "line");

    line.setAttribute("x1", leftRect.left - gameRect.left + leftRect.width / 2);
    line.setAttribute("y1", leftRect.top - gameRect.top + leftRect.height / 2);
    line.setAttribute("x2", rightRect.left - gameRect.left + rightRect.width / 2);
    line.setAttribute("y2", rightRect.top - gameRect.top + rightRect.height / 2);

    line.setAttribute("stroke-width", "6");

    if (leftColor === rightColor) {
        // Correct match
        line.setAttribute("stroke", leftColor);
        svg.appendChild(line);

        selectedLeft.classList.add("connected");
        rightWire.classList.add("connected");

        connections[leftColor] = true;
        correctMatches++;

        playSound(true);

        checkWin();
    } else {
        // Wrong match
        line.setAttribute("stroke", "red");
        svg.appendChild(line);

        selectedLeft.classList.add("wrong");
        rightWire.classList.add("wrong");

        playSound(false);

        setTimeout(() => {
            svg.removeChild(line);
            selectedLeft.classList.remove("wrong");
            rightWire.classList.remove("wrong");
        }, 500);
    }

    selectedLeft = null;
}

/* ==========================================
   CHECK WIN CONDITION
   Displays message and reset button
========================================== */
function checkWin() {
    if (correctMatches === colors.length) {
        document.getElementById("message").style.display = "block";
        document.getElementById("resetBtn").style.display = "inline-block";
    }
}

/* ==========================================
   SIMPLE SOUND EFFECTS
   Uses Web Audio API
========================================== */
function playSound(success) {
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    const oscillator = audioCtx.createOscillator();
    const gainNode = audioCtx.createGain();

    oscillator.connect(gainNode);
    gainNode.connect(audioCtx.destination);

    oscillator.frequency.value = success ? 600 : 200;
    oscillator.type = "sine";

    oscillator.start();
    gainNode.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + 0.3);
}

/* ==========================================
   RESET BUTTON EVENT
========================================== */
document.getElementById("resetBtn").addEventListener("click", initWires);

/* ==========================================
   START GAME ON LOAD
========================================== */
initWires();
</script>

</body>
</html>
